global {
  lan_interface: br-lan,WireGuard
  wan_interface: auto
  log_level: info
  allow_insecure: false
  auto_config_kernel_parameter: true
  dial_mode: ip
}

dns {
  upstream {
    smartdns: 'udp://127.0.0.1:55553'
    fakeip: 'udp://127.0.0.1:7853'
  }
  routing {
    request {
      qname(geosite:private) -> smartdns
      qname(geosite:cn, geosite:apple@cn, geosite:microsoft@cn) -> smartdns
      qname(suffix: cyt-and-ls-love.top) -> smartdns
      fallback: fakeip
    }
  }
}

node {
  proxy: 'socks5://localhost:32520'
}

group {
  proxy {
    policy: fixed(0)
  }
}

routing {
  pname(mihomo) -> must_direct
  pname(smartdns) && l4proto(udp) && dport(53,7853) -> must_direct

  dip(198.18.0.0/16) -> proxy
  dip(geoip:cn) -> direct
  dip(geoip:private) -> direct
  dscp(2) -> direct
  fallback: proxy
}
